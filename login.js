// Проверка авторизации
if (requireAuth()) {
    // Пользователь авторизован
}

// Проверка роли админа
if (requireAuth('admin')) {
    // Только для админа
}

// Вызов защищенной функции
adminOnlyFunction();